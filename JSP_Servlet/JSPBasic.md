
![author](https://img.shields.io/badge/author-daesungRa-lightgray.svg?style=flat-square)
![date](https://img.shields.io/badge/date-190114-lightgray.svg?style=flat-square)

참조: 최범균의 JSP 2.3 웹 프로그래밍

## JSP

> MVC 에서 View 단으로 많이 활용되는 JSP 이다

### 전체적인 구조

- JSP 페이지에는 View 를 위한 HTML, CSS, Javascript, JSP 소스가 혼재한다
- 게다가 JSP 문법 내에는 Java 코드도 포함될 수 있다
- 백엔드와 관련된 핵심적인 처리는 웹서버 컨테이너, 즉 서블릿이 수행하지만,
- 프론트 단에서 간단한 데이터 정제작업은 JSP 페이지에서 JS 코드를 활용해 수행한다(요즘은 이것도 굉장히 정교하다)
- 웹앱의 기본 구조
	* ContextPath : 웹앱의 Root. 현재는 WebContent 폴더로 표현됨
		- 톰캣 컨테이너의 server.xml 설정파일과 웹 프로젝트의 Properties 의 Web Project Settings 설정으로 Context Root 를 지정할 수 있다
		- 환경설정 정보를 제외한 HTML, CSS, JS, JSP, 이미지 등의 기타 웹앱 View 요소들을 주제별로 폴더링하여 저장
	* /WEB-INF : 각종 환경설정 정보들이 위치함
		- web.xml : 해당 웹 프로젝트의 환경설정 정보 기록. 서블릿 초기화 파라미터, 각종 매핑, 세션 유효시간, 리스너/필터 설정 등등
		- /classes : 컴파일된 클래스 실행소스가 위치함
		- /lib : 웹서버 구동에 필요한 라이브러리 (jdbc 같은) 가 위치한다
	* Java Resources : 서버의 동적 처리를 위한 서블릿 소스코드가 위치함 (패키지 지정)

### JSP 페이지 구성요소
	* 지시자-페이지 디렉티브 : 페이지에 대한 정의 및 환경설정
	* 스크립트 요소-스크립트릿 : 간단한 JSP (Java) 로직 수행
	* 스크립트 요소-표현식 : HTML 코드 중간에서 데이터 표현
	* 스크립트 요소-선언문 : 페이지 내 전역형 멤버 선언
	* 중요한 객체들-request, response
		- 뷰 페이지에서 사용자의 요청정보가 담겨 서버로 전송, 서버의 응답내용이 담겨 사용자에게 전달됨(적절한 페이지 처리도 포함)
		- 전달 값에 대한 처리 : getParameter, getParameterValues 등의 파라미터 관련 메서드를 사용하면 된다
	* 액션 태그
		- include, param, forward, useBean 등의 액션 태그를 사용한다
		- jsp:include 액션 태그로 로드한 페이지는 자신을 호출한 원본 페이지의 request 파라미터 값을 공유한다
		- 혹은 include 내에 jsp:param 액션태그로 파라미터 속성을 지정할 수도 있다



### request, response

- request : 사용자의 요청 정보가 파라미터로 담긴다. Get 방식이라면 요청 헤더에, Post 방식이라면 바디에 파라미터 값이 포함된다
- response : 요청받은 데이터를 처리하고 응답을 브라우저에 전송한다


### 리다이렉트

- JSP 에서 페이지 이동에는 redirect 와 forward 두 방식이 있는데, 전자는 새로운 페이지 요청, 후자는 기존 페이지에 요청 페이지 로딩으로 요약 가능하다
- response.sendRedirect("[이동할 페이지]")
	* 이것은 브라우저의 페이지 자체를 이동시키는 것이다. (이동할 페이지를 다시 호출하여 나타냄)
	* 브라우저의 요청은 서버에서 처리되어 서버는 브라우저에게 sendRedirect 로 지정한 페이지에 대한 정보를 넘기고 (이 페이지로 넘어가라!),
	* 브라우저는 그 정보를 바탕으로 서버에 다시 요청을 보내 최종적인 페이지 응답을 받게 된다
- forward
- 그러니까 redirect 는 브라우저가 서버에 총 두 번 페이지요청을 하고, forward 는 한 번만 한다. 그것도 서버 컨테이너 내에서만 처리되므로 URI 가 바뀌지는 않음




### 로그인 로직 만들기






#### 웹앱 만들때 고려할 것 세 개

- 로그인 및 세션
- 게시판
- 디비



### 이슈

1. 빈번히 사용되지만 다소 복잡한 로직은 어떻게 할까?

- HTTP 프로토콜은 비저장성이다
- 그러므로 웹 페이지마다 일일히 데이터 교환 로직을 만들지 않으면 페이지 이동 시 값이 그냥 버려진다
- 하다못해 자기 페이지를 리로드 해도 지금까지 입력한 데이터는 남아 있어야 한다
- 이런 점이 개발자로 하여금 많은 스트레스를 받게 한다
- 어쨌든 데이터 보존 이슈는 매우 중요하므로, 필요에 따라 빨리 사용할 수 있도록 사전에 외워둬야 한다
- 이해하는 것도 필요하긴 하지만, 외워서 빠르게 사용할줄 아는 것도 필요하다

2. 

- 톰캣 인코딩 설정

3. DB 커넥팅

- jdbc 라이브러리 세팅 방식
	* 웹앱 프로젝트의 Build Path 라이브러리 목록에 사용할 jdbc 라이브러리 추가
	* 웹앱/WEB-INF/lib 폴더 내에 jdbc 라이브러리가 위치하도록 세팅
	* 전자는 현재 실행중인 이클립스 프로젝트 내에서만 적용되고, 후자는 추후 어플을 배포할 때 jdbc 도 함께 배포된다

4. 로그인 상태 유지, 일회용 로그인 등 처리

- 쿠키 사용하기
- HTML5 구현 서버라면, local storage 에 해당 유저의 상태값 저장
	* session storage 는 브라우저를 종료하면 사라지지만 local storage 는 남아있는다

5. CSS - index 페이지 자동 사이즈 조절



































