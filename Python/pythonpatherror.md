
![author](https://img.shields.io/badge/author-daesungRa-lightgray.svg?style=flat-square)
![date](https://img.shields.io/badge/date-190514-lightgray.svg?style=flat-square)

# 파이썬 경로에러 - 같은 패키지 파일인데도 import 가 안 된다??

- 사용 툴은 pycharm 인데..
- 지난번까지는 잘 됐던거 같은데
- 같은 패키지(__init__.py 파일이 존재해도) 내부의 py 파일 간에 서로 인식이 안 된다..
- import 가 먹히지 않고 에러 발생
- 이유를 몰라 한참 삽질하다가
- 빨간줄 그대로 두고 그냥 앱을 실행했더니 돌아가긴 또 잘 돌아간다..
- 이유가 뭐지??

---

**(190515, wed, 다음날..)**

## 문제 원인 파악

- 어제와 마찬가지로 같은 패키지 내에서 파이썬 파일들이 서로간에 인식이 되지 않았다.
- 외부에서 패키지 임포트하는 경우, 패키지인 것을 명시하기 위해 \_\_init__.py 파일을 생성 (없어도 됨)
- flask 웹앱
    * 외부에서 인식 잘됨
    * 내부에서 직접적으로는 안됨
        - 그런데 파이참 상에서 인식은 안되지만(빨간줄 및 추천사항 없음) 그냥 구동하면 인식한 대로 잘 된다
    * 상위폴더를 포함한 경로로 내부에서 import 하면 됨
        - 단, import 까지는 되도 구동 자체가 안되는 경우가 있는데 다음과 같은 때이다.
        ```text
        ## 에러 메시지
        Traceback (most recent call last):
          File "../test-app/app/test.py", line 1, in <module>
            from app.app import app
        ModuleNotFoundError: No module named 'app.app'; 'app' is not a package
        ```
        - 이때는 패키지 구성이 app.app 의 app 모듈인 경우로, (패키지.모듈 의 app 객체)
        - 첫째로 키워드와 중복되거나, 둘째로 패키지명과 모듈명이 같은 것 둘중 하나가 원인으로 보인다.

### 가설 1. 가상환경 문제

- 첫 번째 든 생각은 새롭게 사용한 **pipenv** 툴 문제이지 않을까란 것이었다.
- 툴 자체가 업데이트가 느리고 블랙박스 동작이 많다고 하였으니.. ([관련링크](https://velog.io/@doondoony/pipenv-101))
- 그래서 기존의 **virtualenv + pip3** 방식으로 만든 테스트 프로젝트와, **pipenv** 로 만든 테스트 프로젝트를 가지고 실험해 봤다.
- 결론적으로는 둘다 같았다. 동작 및 에러 내용 모두..

### 가설 2. 문법 오류 (경로 명시 + 이름이 키워드와 중복)

- 일단 전제는 내부 모듈끼리의 import 이다. (외부에서는 어떤 경우에서든 인식 가능)
- 일단 파이썬 기초문법에 따르면,
- 별다른 설정이 없어도 같은 상위경로 내부에 존재하는 파이썬 모듈들은 서로간에 직접적인 인식이 가능하다.
- 그러나 파이참으로 작성한 flask 코드에서는 인식 자체가 되지 않았으나 (```import [import 할 모듈]```), 무시하고 그냥 execute 하면 본래 문법 대로 동작했다.
- 인식 불가의 문제 해결을 위해 ```from [상위폴더].[import 할 모듈] import [flask app]``` 방식으로 했더니 인식했다.
- 그러나 단 한 경우에서 에러가 발생했는데(이번에는 인식은 되는데 execute 시 에러 발생),
    * 그것은 ```from app.app import flask_app``` 과 같이 패키지명과 모듈명이 동일한 경우였다. (내부 import 라는 전제)
    * 에러 메시지는 'app.app' 모듈 자체를 찾지 못하겠다는 것.
    * 이때 상호간에 이름을 다르게 했더니 에러 없이 잘 동작했다. ```from application.app import flask_app``` 이런 식으로..
- 이 문제의 원인이 **키워드와의 중복**에 있지 않을까 생각했지만, 물론 그것도 문제지만 지금 상황에서는 네이밍 중복 때문인것 같다.

### 가설 3. 파이참 문제

- 일단 같은 패키지 내부에서 상호간에 import 인식조차 되지 않으면서
- 파이썬 문법에 따라동작은 가능하던 문제점을 고려하면
- 이것은 **파이참 툴 자체**나 **기타 제 3의 요인** 때문에 발생한 해프닝?으로 보인다. (어쨌든 동작은 하니..)

### 결론

1. 패키지와 패키지에 포함된 모듈명은 다르게 만들기!
    * 그런데 외부에서 import 할때는 같아도 문제가 없다.. (어떤 상황이든 가능)
    * 내부에서 import 할때만 에러가 발생한다는 것. (이름이 다르다면 빨간줄이 뜨던말던 문제 없다.)
    * 구조적인 이유가 있지 않을까?
    * 깔끔한 해결을 위해서라면, 첫째로 이름을 다르게 만들고, 상위디렉토리 경로를 포함하여 import 하면 된다.
2. 문법상 같은 패키지 내부에서 직접적으로 import 가능하다.
    * (파이참 혹은 제 3 요인 때문) 임포트 에러가 발생해도 쫄지말고 문법대로 가자!
3. 외부 패키지에서 


